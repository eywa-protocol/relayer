version: '3.6'

services:

  node:
    build:
      context: ../
      dockerfile: ./p2p-bridge/Dockerfile
    depends_on:
      - ganache_net1
      - ganache_net2
    environment:
        - PORT=0
        - TYPE_ADAPTER_ENV=bootstrap.env
        - ECDSA_KEY_1=0x187994e6d93bb29e386fe7ab50232a6a2bea5d6f61046b803b9e9b8306b7d268
        - ECDSA_KEY_2=0xdd9a03e0e395072e4f8b96952264a3cb30efa28bf98342e197d2af8a3d6fc541
    networks:
      - static-network

  ganache_net1:
    build:
      context: ../
      dockerfile: ./eth-contracts/truffle/docker/network1/ganache/Dockerfile
    networks:
      static-network:
        ipv4_address: 172.20.128.11
    ports:
     - "7545:7545"

  ganache_net2:
    build:
      context: ../
      dockerfile: ./eth-contracts/truffle/docker/network2/ganache/Dockerfile
    networks:
      static-network:
        ipv4_address: 172.20.128.12
    ports:
     - "8545:8545"

networks:
  static-network:
    name: dev_net_1
    ipam:
      config:
        - subnet: 172.20.0.0/16
