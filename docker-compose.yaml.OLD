version: '3.6'

services:

  node0:
    build:
      context: ../
      dockerfile: ./p2p-bridge/Dockerfile
    depends_on:
      - ganache_net1
      - ganache_net2
    environment:
        - TYPE_ADAPTER_ENV=bootstrap.env
        - ECDSA_KEY_1=0x187994e6d93bb29e386fe7ab50232a6a2bea5d6f61046b803b9e9b8306b7d268
        - ECDSA_KEY_2=0xdd9a03e0e395072e4f8b96952264a3cb30efa28bf98342e197d2af8a3d6fc541
    networks:
      static-network:
        ipv4_address: 172.20.128.55

  node1:
    build:
      context: ../
      dockerfile: ./p2p-bridge/Dockerfile
    depends_on:
      - ganache_net1
      - ganache_net2
    environment:
      - TYPE_ADAPTER_ENV=bootstrap.env
      - ECDSA_KEY_1=0xf5e350eb75d845a8cd538e06331ee6eeb159c54710c6c84c725cd77e2e0dde59
      - ECDSA_KEY_2=0xd37fe8ab9b9a4f0473c2c7e32b6b218cc398837ce29a548066d52245c345df1a
    networks:
      static-network:
        ipv4_address: 172.20.128.54

  node2:
    build:
      context: ../
      dockerfile: ./p2p-bridge/Dockerfile
    depends_on:
      - ganache_net1
      - ganache_net2
    environment:
      - TYPE_ADAPTER_ENV=bootstrap.env
      - ECDSA_KEY_1=0x9894defbe159c1abba7db3f88b122bf94c6838a28a98af9466e85c8f573c43bc
      - ECDSA_KEY_2=0x95472b385de2c871fb293f07e76a56e8e93ea4e743fe940afbd44c30730211dc
    networks:
      static-network:
        ipv4_address: 172.20.128.53

  node3:
    build:
      context: ../
      dockerfile: ./p2p-bridge/Dockerfile
    depends_on:
      - ganache_net1
      - ganache_net2
    environment:
      - TYPE_ADAPTER_ENV=bootstrap.env
      - ECDSA_KEY_1=0xafd8124dd3abec91d07dca54878cd296666a96decd122cc7646e9357df21a6de
      - ECDSA_KEY_2=0x3fdb56439eb7c05074586993925c6e06103a5b770b46aa29e399cc693d44ddf7
    networks:
      static-network:
        ipv4_address: 172.20.128.58


  node4:
    build:
      context: ../
      dockerfile: ./p2p-bridge/Dockerfile
    depends_on:
      - ganache_net1
      - ganache_net2
    environment:
      - TYPE_ADAPTER_ENV=bootstrap.env
      - ECDSA_KEY_1=0xb433482fbde7e7a9f6fb0d63d60782820dfe8e1f2e58ac9c0281c817d13b64ec
      - ECDSA_KEY_2=0xe84538a8b4059da88d5a76544329093da99603fe05b0f1332f737c74253688c3
    networks:
      static-network:
        ipv4_address: 172.20.128.56

  node5:
    build:
      context: ../
      dockerfile: ./p2p-bridge/Dockerfile
    depends_on:
      - ganache_net1
      - ganache_net2
    environment:
      - TYPE_ADAPTER_ENV=bootstrap.env
      - ECDSA_KEY_1=0xa76afd42e10c31cc170f32489a9f6af28efe2b1e6aede2813c3ec7d2907a05e9
      - ECDSA_KEY_2=0x469e5c05e289274dd8570c31f2f0f21236f2e071613ac9c565821985e7ae641e
    networks:
      static-network:
        ipv4_address: 172.20.128.57




#  dev-adapter:
#   build:
#     context: ../
#     dockerfile: ./p2p-bridge/dev.Dockerfile
#   depends_on:
#     - ganache_net1
#     - ganache_net2
#   environment:
#     - TYPE_ADAPTER_ENV=${TYPE_ADAPTER_ENV}
#     - ECDSA_KEY_1=${ECDSA_KEY_1}
#     - ECDSA_KEY_2=${ECDSA_KEY_2}
#   volumes:
#     - ./:/p2p-bridge
#     - ../eth-contracts/wrappers:/eth-contracts/wrappers
#   networks:
#     static-network:
#       ipv4_address: 172.20.128.88

  ganache_net1:
    build:
      context: ../
      dockerfile: ./eth-contracts/truffle/docker/network1/ganache/Dockerfile
    networks:
      static-network:
        ipv4_address: 172.20.128.11
    ports:
     - "7545:7545"

  ganache_net2:
    build:
      context: ../
      dockerfile: ./eth-contracts/truffle/docker/network2/ganache/Dockerfile
    networks:
      static-network:
        ipv4_address: 172.20.128.12
    ports:
     - "8545:8545"

networks:
  static-network:
    name: dev_net
    ipam:
      config:
        - subnet: 172.20.0.0/16
